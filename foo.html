
<!doctype html>
<html lang="pt" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>Reatribui√ß√£o de vari√°veis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Georgio Barbosa da Fonseca">

  <link rel="shortcut icon" href="">
  <link rel="stylesheet" title="Dracula" href="https://highlightjs.org/static/demo/styles/solarized-dark.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

  <script>
    $(document.body).ready(function() {
        $('pre').each(function(i, block) {
            hljs.highlightBlock(block);
        });
    });
  </script>
  <!-- schema.org -->
  <meta itemprop="name" content="Code Militia">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <!-- Style Meta Data -->
  <link rel="stylesheet" href="https://gfonseca.github.io/theme/css/milligram.css" type="text/css" />
  <link rel="stylesheet" href="https://gfonseca.github.io/theme/css/custom.css" type="text/css" />

  <!-- Feed Meta Data -->
    <link href="https://gfonseca.github.io/atom.xml" type="application/atom+xml" rel="alternate" title="Code Militia ATOM Feed" />

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

<meta name="twitter:creator" content="">
<meta name="twitter:url" content="https://gfonseca.github.io/reatribuicao-de-variaveis.html">
<meta name="twitter:title" content="Code Militia ~ Reatribui√ß√£o de vari√°veis">
<meta name="twitter:description" content="Reatribui√ß√£o de vari√°veis Sauda√ß√µes a todos. üëã Hoje gostaria de falar sobre um pequeno truque envolvendo reatribui√ß√£o de vari√°veis que pode ser desconhecidos pelos ne√≥fitos da linguagem, e que acredito, pode ser muito relevante no desenvolvimento de algoritmos. Vamos direto ao c√≥digo. f, err := os.Open(name) d, err := f.Stat ‚Ä¶">

<!-- Facebook Meta Data -->
<meta property="og:title" content="Code Militia ~ Reatribui√ß√£o de vari√°veis" />
<meta property="og:description" content="Reatribui√ß√£o de vari√°veis Sauda√ß√µes a todos. üëã Hoje gostaria de falar sobre um pequeno truque envolvendo reatribui√ß√£o de vari√°veis que pode ser desconhecidos pelos ne√≥fitos da linguagem, e que acredito, pode ser muito relevante no desenvolvimento de algoritmos. Vamos direto ao c√≥digo. f, err := os.Open(name) d, err := f.Stat ‚Ä¶" />
<meta property="og:image" content="" />
</head>

<body class="crt">
    <div class="container">

    <!-- Navbar -->
      <div class="navbar">
        <ul>
            <div>
                <li>
                    <a href="https://gfonseca.github.io"><h1>Code Militia</h1></a>
                </li>
                <li>
                </li>
            </div>
        </ul>
      </div>

  <!-- Sidebar -->
    <sidebar>
        <ul class="static-item">

        </ul>

        <ul>
                <div class="cat-border">
                <li style="color: #F2F1EF; background-color: #6C7A89;">Categories</li>
                    <li><a href="https://gfonseca.github.io/category/golang.html">golang</a></li>
                </div>
        </ul>

   
        <p>
        </p>
        <p>
            <a href="https://gfonseca.github.io/atom.xml" rel="alternate">
                <img class="social-icons-m" src="https://gfonseca.github.io/theme/images/icons/rss.png"></a>
        </p>
        <p>
        </p>
    </sidebar>
    
    <maincontent>
<h2>
    <a href="https://gfonseca.github.io/reatribuicao-de-variaveis.html" rel="bookmark" title="Permalink to Reatribui√ß√£o de vari√°veis">Reatribui√ß√£o de vari√°veis</a>
</h2>

<div>
    <b>By: </b><a href="https://gfonseca.github.io/author/georgio-barbosa-da-fonseca.html">Georgio Barbosa da Fonseca</a><b>    On: </b>Wed 01 November 2017<br />
    <b>In: </b><a href="https://gfonseca.github.io/category/golang.html" rel="bookmark" title="Permalink to golang">golang</a><br />
    <em><b>Tags: </b>
    </em>
    <hr>
</div>

<div>
    <mainarticle>
    <h1>Reatribui√ß√£o de vari√°veis</h1>
<p>Sauda√ß√µes a todos. &#128075;
Hoje gostaria de falar sobre um pequeno truque envolvendo reatribui√ß√£o de vari√°veis que pode ser desconhecidos pelos ne√≥fitos da linguagem, e que acredito, pode ser muito relevante no desenvolvimento de algoritmos.</p>
<p>Vamos direto ao c√≥digo.</p>
<div class="highlight"><pre><span></span><span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
<span class="nx">d</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Stat</span><span class="p">()</span>
</pre></div>


<p>Esta √© uma opera√ß√£o legal!</p>
<p>Na maioria dos casos quando utilizamos a <a href="https://golang.org/ref/spec#Short_variable_declarations">Short variable delcarations</a> ( := ) o compilador n√£o nos permite utiliz√° lo uma segunda vez com a mesma vari√°vel, j√° que essa opera√ß√£o nada mais √© do que uma abrevia√ß√£o de uma declara√ß√£o tradicional de vari√°vel.</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">d</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="c1">// equivale a:</span>
<span class="kd">var</span> <span class="nx">d</span> <span class="o">:=</span> <span class="mi">1</span>
</pre></div>


<h3>Vejamos um exemplo</h3>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">d</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">d</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>


<h3>Sa√≠da</h3>
<div class="highlight"><pre><span></span>./reatribuicao-de-variaveis.go:9: no new variables on left side of :=
</pre></div>


<p>Como eu havia dito, o compilador n√£o permite redeclarar uma vari√°vel no mesmo escopo, por√©m, por pragmatismo, existe uma situa√ß√£o em que voc√™ pode utilizar uma vari√°vel previamente declarada com o <em>Short variable declaration</em> e o compilador j√° havia nos dado est√° dica:<br/><br/></p>
<p><strong>no new variables on left side of :=</strong>
<br/><br/></p>
<h3>Resolvendo o problema</h3>
<p>https://golang.org/doc/effective_go.html#redeclaration</p>
<blockquote>
<p>In a := declaration a variable v may appear even if it has already been declared, provided:</p>
<ul>
<li>this declaration is in the same scope as the existing declaration of v (if v is already declared in an outer scope, the declaration will create a new variable ¬ß),</li>
<li>the corresponding value in the initialization is assignable to v, and</li>
<li>there is at least one other variable in the declaration that is being declared anew.</li>
</ul>
</blockquote>
<p>A solu√ß√£o √© simples, caso exista ao menos uma vari√°vel ainda n√£o declarada do lado esquerdo do operador := √© permitido utiliz√° lo para alterar valores de vari√°veis j√° declaradas.</p>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;os&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;/tmp/reasign&quot;</span><span class="p">)</span>
    <span class="nx">s</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Stat</span><span class="p">()</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Falha ao abrir o arquivo&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>


<p>A exist√™ncia da vari√°vel <strong><em>d</em></strong> no comando <strong><em>d, err := f.Stat()</em></strong> permitiu a reatribui√ß√£o da vari√°vel <strong><em>err</em></strong>.</p>
<p>Perceba que isso n√£o passa de uma reatribui√ß√£o, e n√£o uma redeclara√ß√£o de vari√°veis, em outras palavras, este atalho n√£o nos permite alterar o tipo de uma vari√°vel previamente declarada, o que torna a opera√ß√£o  a seguir ilegal.</p>
<div class="highlight"><pre><span></span>    <span class="nx">j</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="nx">e</span><span class="p">,</span> <span class="nx">j</span> <span class="o">:=</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span>
</pre></div>


<h3>Sa√≠da</h3>
<div class="highlight"><pre><span></span>cannot use &quot;bar&quot; (type string) as type int in assignment
</pre></div>


<h3>Finalizando &#127859;</h3>
<p>Este conhecimento vem a ser √∫til pois pelo que tenho visto at√© o momento, o uso do nome de vari√°vel <em>err</em> √© muito comum no tratamento de exce√ß√µes, j√° que n√£o temos exce√ß√µes nativas em golang e o retorno de m√∫ltiplos valores por fun√ß√µes se torna o principal dispositivo na captura de falhas.</p>
<div class="highlight"><pre><span></span><span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Open</span><span class="p">(</span><span class="s">&quot;/tmp/reasign&quot;</span><span class="p">)</span>
<span class="nx">s</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">f</span><span class="p">.</span><span class="nx">Stat</span><span class="p">()</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>

<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Falha ao abrir o arquivo&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;&gt;&gt;&gt;&quot;</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
</pre></div>


<p><a href="/code/reatribuicao-de-variaveis.go">Download do exemplo</a><br/>
Por hoje √© s√≥. &#128640;</p>
    </mainarticle>
</div>
<hr>
        
<div>
        <i>If you found the article helpful, please share or cite the article, and spread the word:</i>
            <p style="margin-top: 2%;">
                <span><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=https://gfonseca.github.io/reatribuicao-de-variaveis.html&text=Reatribui√ß√£o de vari√°veis&via="><img class="social-icons-a" src="https://gfonseca.github.io/theme/images/icons/twitter.png"></a></span>
                <span><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=https://gfonseca.github.io/reatribuicao-de-variaveis.html&t=Reatribui√ß√£o de vari√°veis"><img class="social-icons-a" src="https://gfonseca.github.io/theme/images/icons/facebook.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://gfonseca.github.io/reatribuicao-de-variaveis.html&title=Reatribui√ß√£o de vari√°veis" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img class="social-icons-a" src="https://gfonseca.github.io/theme/images/icons/linkedin.png"></a>
            </p>
</div>
<hr>
    <p><i>For any feedback or corrections, please write in to: </i><b> georgio.barbosa@gmail.com </b></p>
        
    </maincontent>

  <!-- Analytics -->

  </div>
</body>

</html>